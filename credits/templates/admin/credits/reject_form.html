{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'admin/css/forms.css' %}">
    <style>
        .form-row {
            overflow: hidden;
            padding: 10px;
            margin-bottom: 10px;
        }
        .form-row label {
            float: left;
            width: 150px;
            font-weight: bold;
            color: #666;
        }
        .form-row input, .form-row textarea {
            margin-left: 160px;
        }
        .submit-row {
            padding: 12px 14px;
            margin: 0 0 20px;
            background: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: right;
        }
        .default {
            background: #417690;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .default:hover {
            background: #205067;
        }
        .cancel-link {
            background: #ba2121;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 4px;
        }
        .cancel-link:hover {
            background: #a41515;
            color: white;
        }
        .credit-info {
            background: #f0f8ff;
            border: 1px solid #b8d4f0;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .credit-info h3 {
            margin-top: 0;
            color: #2c5282;
        }
        .info-item {
            margin: 8px 0;
        }
        .info-label {
            font-weight: bold;
            color: #4a5568;
            display: inline-block;
            width: 120px;
        }
        .amount-highlight {
            color: #e53e3e;
            font-weight: bold;
            font-size: 1.1em;
        }
        .vendor-highlight {
            color: #2d3748;
            font-weight: bold;
        }
    </style>
{% endblock %}

{% block content %}
<div id="content-main">
    <div class="credit-info">
        <h3>ğŸ” Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø¹ØªØ¨Ø§Ø±</h3>
        <div class="info-item">
            <span class="info-label">ÙØ±ÙˆØ´Ù†Ø¯Ù‡:</span>
            <span class="vendor-highlight">{{ credit_request.vendor.name }}</span>
        </div>
        <div class="info-item">
            <span class="info-label">Ù…Ø¨Ù„Øº:</span>
            <span class="amount-highlight">{{ credit_request.amount|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</span>
        </div>
        <div class="info-item">
            <span class="info-label">ØªØ§Ø±ÛŒØ® Ø¯Ø±Ø®ÙˆØ§Ø³Øª:</span>
            <span>{{ credit_request.created_at|date:"Y/m/d H:i" }}</span>
        </div>
        <div class="info-item">
            <span class="info-label">ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:</span>
            <span>{{ credit_request.get_status_display }}</span>
        </div>
    </div>

    <form method="post" id="reject-form">
        {% csrf_token %}

        <div>
            <fieldset class="module aligned">
                <h2>âŒ Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø¹ØªØ¨Ø§Ø±</h2>

                <div class="form-row">
                    <div>
                        <label for="id_reason" class="required">Ø¯Ù„ÛŒÙ„ Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª:</label>
                        <textarea
                            name="reason"
                            id="id_reason"
                            cols="80"
                            rows="5"
                            required
                            placeholder="Ù„Ø·ÙØ§Ù‹ Ø¯Ù„ÛŒÙ„ Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø±Ø§ Ø¨Ù‡ Ø·ÙˆØ± Ú©Ø§Ù…Ù„ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
                            style="width: 100%; max-width: 600px; font-family: Tahoma, Arial, sans-serif; font-size: 13px; direction: rtl;"
                        ></textarea>
                        <p class="help">
                            <small style="color: #666;">
                                ğŸ’¡ Ø§ÛŒÙ† Ø¯Ù„ÛŒÙ„ Ø¨Ù‡ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯. Ù„Ø·ÙØ§Ù‹ Ø¯Ù‚ÛŒÙ‚ Ùˆ Ù…ÙÛŒØ¯ Ø¨Ø§Ø´Ø¯.
                            </small>
                        </p>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="submit-row">
            <input type="submit" value="âœ… ØªØ£ÛŒÛŒØ¯ Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª" class="default" name="_reject"
                   onclick="return confirm('Ø¢ÛŒØ§ Ø§Ø² Ø±Ø¯ Ø§ÛŒÙ† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')">
            <a href="{% url 'admin:credits_creditrequest_changelist' %}"
               class="cancel-link">
                âŒ Ø§Ù†ØµØ±Ø§Ù
            </a>
        </div>
    </form>

    <script>
        document.getElementById('reject-form').addEventListener('submit', function(e) {
            var reason = document.getElementById('id_reason').value.trim();
            if (reason.length < 10) {
                alert('Ø¯Ù„ÛŒÙ„ Ø±Ø¯ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ 10 Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯.');
                e.preventDefault();
                return false;
            }

            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø±Ø¯ Ø§ÛŒÙ† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ\n\nÙØ±ÙˆØ´Ù†Ø¯Ù‡: ' +
                        '{{ credit_request.vendor.name }}\n' +
                        'Ù…Ø¨Ù„Øº: {{ credit_request.amount|floatformat:0 }} ØªÙˆÙ…Ø§Ù†')) {
                e.preventDefault();
                return false;
            }
        });

        // Auto focus on reason textarea
        document.getElementById('id_reason').focus();
    </script>
</div>
{% endblock %}
